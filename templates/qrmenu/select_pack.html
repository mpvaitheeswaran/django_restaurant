{%extends 'base/non_auth_base.html'%}
{%load static%}
{%block stylesheet%}
<link rel="stylesheet" href="{%static 'css/select_pack.css'%}">
{%endblock%}
{%block content%}
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm ">
    <a class="navbar-brand" href="{%url 'dashboard'%}">RestaurantQR</a>

    <div class="ml-auto">
      <ul class="navbar-nav">
        <li class="nav-item active">
          <a class="btn btn-primary" href="{%url 'restaurant'%}">Continue <i class='bx bxs-chevrons-right'></i><span class="sr-only">(current)</span></a>
        </li>
      </ul>
    </div>
  </nav>
  <!-- Navbar End -->

    <!--SELECT PACK MODAL  -->
    <!-- Trial Pack -->
    <div class="modal fade" id="trial_pack_modal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Terms & Condisions</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" style="white-space: pre-line;">
                
                    
                    What follows is just some placeholder text for this modal dialog. You just gotta ignite the light and let it shine! Come just as you are to me. Just own the night like the 4th of July. Infect me with your love and fill me with your poison. Come just as you are to me. End of the rainbow looking treasure.
                    
                    I can't sleep let's run away and don't ever look back, don't ever look back. I can't sleep let's run away and don't ever look back, don't ever look back. Yes, we make angels cry, raining down on earth from up above. I'm walking on air (tonight). Let you put your hands on me in my skin-tight jeans. Stinging like a bee I earned my stripes. I went from zero, to my own hero. Even brighter than the moon, moon, moon. Make 'em go, 'Aah, aah, aah' as you shoot across the sky-y-y! Why don't you let me stop by?
                    
                    Boom, boom, boom. Never made me blink one time. Yeah, you're lucky if you're on her plane. Talk about our future like we had a clue. Oh my God no exaggeration. You're original, cannot be replaced. The girl's a freak, she drive a jeep in Laguna Beach. It's no big deal, it's no big deal, it's no big deal. In another life I would make you stay. I'm ma get your heart racing in my skin-tight jeans. I wanna walk on your wave length and be there when you vibrate Never made me blink one time.
                    
                    We'd keep all our promises be us against the world. In another life I would be your girl. We can dance, until we die, you and I, will be young forever. And on my 18th Birthday we got matching tattoos. So open up your heart and just let it begin. 'Cause she's the muse and the artist. She eats your heart out. Like Jeffrey Dahmer (woo). Pop your confetti. (This is how we do) I know one spark will shock the world, yeah yeah. If you only knew what the future holds.
                    
                    Sipping on Rosé, Silver Lake sun, coming up all lazy. It’s in the palm of your hand now baby. So we hit the boulevard. So make a wish, I'll make it like your birthday everyday. Do you ever feel already buried deep six feet under? It's time to bring out the big balloons. You could've been the greatest. Passport stamps, she's cosmopolitan. Your kiss is cosmic, every move is magic.
                    
                    We're living the life. We're doing it right. Open up your heart. I was tryna hit it and quit it. Her love is like a drug. Always leaves a trail of stardust. The girl's a freak, she drive a jeep in Laguna Beach. Fine, fresh, fierce, we got it on lock. All my girls vintage Chanel baby.
                    
                    Before you met me I was alright but things were kinda heavy. Peach-pink lips, yeah, everybody stares. This is no big deal. Calling out my name. I could have rewrite your addiction. She's got that, je ne sais quoi, you know it. Heavy is the head that wears the crown. 'Cause, baby, you're a firework. Like thunder gonna shake the ground.
                    
                    Just own the night like the 4th of July! I’m gon’ put her in a coma. What you're waiting for, it's time for you to show it off. Can't replace you with a million rings. You open my eyes and I'm ready to go, lead me into the light. And here you are. I’m gon’ put her in a coma. Come on, let your colours burst. So cover your eyes, I have a surprise. As I march alone to a different beat. Glitter all over the room pink flamingos in the pool.
                    
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <a href="{%url 'qrmenu-activate_trial'%}" class="btn btn-primary">Accept</a>
              </div>
            </div>
          </div>
    </div>
    <!-- Monthly Pack -->
    <div class="modal fade" id="monthly_pack_modal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Terms & Condisions</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" style="white-space: normal;">
                
                    
                    What follows is just some placeholder text for this modal dialog. You just gotta ignite the light and let it shine! Come just as you are to me. Just own the night like the 4th of July. Infect me with your love and fill me with your poison. Come just as you are to me. End of the rainbow looking treasure.
                    
                    I can't sleep let's run away and don't ever look back, don't ever look back. I can't sleep let's run away and don't ever look back, don't ever look back. Yes, we make angels cry, raining down on earth from up above. I'm walking on air (tonight). Let you put your hands on me in my skin-tight jeans. Stinging like a bee I earned my stripes. I went from zero, to my own hero. Even brighter than the moon, moon, moon. Make 'em go, 'Aah, aah, aah' as you shoot across the sky-y-y! Why don't you let me stop by?
                    
                    Boom, boom, boom. Never made me blink one time. Yeah, you're lucky if you're on her plane. Talk about our future like we had a clue. Oh my God no exaggeration. You're original, cannot be replaced. The girl's a freak, she drive a jeep in Laguna Beach. It's no big deal, it's no big deal, it's no big deal. In another life I would make you stay. I'm ma get your heart racing in my skin-tight jeans. I wanna walk on your wave length and be there when you vibrate Never made me blink one time.
                    
                    We'd keep all our promises be us against the world. In another life I would be your girl. We can dance, until we die, you and I, will be young forever. And on my 18th Birthday we got matching tattoos. So open up your heart and just let it begin. 'Cause she's the muse and the artist. She eats your heart out. Like Jeffrey Dahmer (woo). Pop your confetti. (This is how we do) I know one spark will shock the world, yeah yeah. If you only knew what the future holds.
                    
                    Sipping on Rosé, Silver Lake sun, coming up all lazy. It’s in the palm of your hand now baby. So we hit the boulevard. So make a wish, I'll make it like your birthday everyday. Do you ever feel already buried deep six feet under? It's time to bring out the big balloons. You could've been the greatest. Passport stamps, she's cosmopolitan. Your kiss is cosmic, every move is magic.
                    
                    We're living the life. We're doing it right. Open up your heart. I was tryna hit it and quit it. Her love is like a drug. Always leaves a trail of stardust. The girl's a freak, she drive a jeep in Laguna Beach. Fine, fresh, fierce, we got it on lock. All my girls vintage Chanel baby.
                    
                    Before you met me I was alright but things were kinda heavy. Peach-pink lips, yeah, everybody stares. This is no big deal. Calling out my name. I could have rewrite your addiction. She's got that, je ne sais quoi, you know it. Heavy is the head that wears the crown. 'Cause, baby, you're a firework. Like thunder gonna shake the ground.
                    
                    Just own the night like the 4th of July! I’m gon’ put her in a coma. What you're waiting for, it's time for you to show it off. Can't replace you with a million rings. You open my eyes and I'm ready to go, lead me into the light. And here you are. I’m gon’ put her in a coma. Come on, let your colours burst. So cover your eyes, I have a surprise. As I march alone to a different beat. Glitter all over the room pink flamingos in the pool.
                    
              </div>
              <div class="modal-footer" id="monthly_modal_foot">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <form action="{%url 'payments-pay'%}">
                    <input type="hidden" name="pack_type" id="pack_type" value="1">
                    <input type="submit" class="btn btn-primary" value="Accept & Pay">
                </form>
                <!-- <a href="{%url 'payments-pay'%}" class="btn btn-primary">Accept & Pay</a> -->
                
              </div>
            </div>
          </div>
    </div>
    <!-- Yearly Pack -->
    <div class="modal fade" id="yearly_pack_modal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Terms & Condisions</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" style="white-space: normal;">
                
                    
                    What follows is just some placeholder text for this modal dialog. You just gotta ignite the light and let it shine! Come just as you are to me. Just own the night like the 4th of July. Infect me with your love and fill me with your poison. Come just as you are to me. End of the rainbow looking treasure.
                    
                    I can't sleep let's run away and don't ever look back, don't ever look back. I can't sleep let's run away and don't ever look back, don't ever look back. Yes, we make angels cry, raining down on earth from up above. I'm walking on air (tonight). Let you put your hands on me in my skin-tight jeans. Stinging like a bee I earned my stripes. I went from zero, to my own hero. Even brighter than the moon, moon, moon. Make 'em go, 'Aah, aah, aah' as you shoot across the sky-y-y! Why don't you let me stop by?
                    
                    Boom, boom, boom. Never made me blink one time. Yeah, you're lucky if you're on her plane. Talk about our future like we had a clue. Oh my God no exaggeration. You're original, cannot be replaced. The girl's a freak, she drive a jeep in Laguna Beach. It's no big deal, it's no big deal, it's no big deal. In another life I would make you stay. I'm ma get your heart racing in my skin-tight jeans. I wanna walk on your wave length and be there when you vibrate Never made me blink one time.
                    
                    We'd keep all our promises be us against the world. In another life I would be your girl. We can dance, until we die, you and I, will be young forever. And on my 18th Birthday we got matching tattoos. So open up your heart and just let it begin. 'Cause she's the muse and the artist. She eats your heart out. Like Jeffrey Dahmer (woo). Pop your confetti. (This is how we do) I know one spark will shock the world, yeah yeah. If you only knew what the future holds.
                    
                    Sipping on Rosé, Silver Lake sun, coming up all lazy. It’s in the palm of your hand now baby. So we hit the boulevard. So make a wish, I'll make it like your birthday everyday. Do you ever feel already buried deep six feet under? It's time to bring out the big balloons. You could've been the greatest. Passport stamps, she's cosmopolitan. Your kiss is cosmic, every move is magic.
                    
                    We're living the life. We're doing it right. Open up your heart. I was tryna hit it and quit it. Her love is like a drug. Always leaves a trail of stardust. The girl's a freak, she drive a jeep in Laguna Beach. Fine, fresh, fierce, we got it on lock. All my girls vintage Chanel baby.
                    
                    Before you met me I was alright but things were kinda heavy. Peach-pink lips, yeah, everybody stares. This is no big deal. Calling out my name. I could have rewrite your addiction. She's got that, je ne sais quoi, you know it. Heavy is the head that wears the crown. 'Cause, baby, you're a firework. Like thunder gonna shake the ground.
                    
                    Just own the night like the 4th of July! I’m gon’ put her in a coma. What you're waiting for, it's time for you to show it off. Can't replace you with a million rings. You open my eyes and I'm ready to go, lead me into the light. And here you are. I’m gon’ put her in a coma. Come on, let your colours burst. So cover your eyes, I have a surprise. As I march alone to a different beat. Glitter all over the room pink flamingos in the pool.
                    
              </div>
              <div class="modal-footer" id="yearly_modal_foot">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <form action="{%url 'payments-pay'%}">
                    <input type="hidden" name="pack_type" id="pack_type" value="2">
                    <input type="submit" class="btn btn-primary" value="Accept & Pay">
                </form>
                <!-- <a href="{%url 'payments-pay'%}" class="btn btn-primary">Accept & Pay</a> -->
                
              </div>
            </div>
          </div>
    </div>
    <!--SELECT PACK MODAL END -->
    {%comment%}
    <div class="d-flex justify-content-center align-items-center mt-5">
        <div class="container-fluid mx-5">
            <div class="text-center mb-5">
                <h1 class="text-center ">Package plan</h1>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" name="currency" type="radio" id="currency_inr" checked value="inr">
                    <label class="form-check-label" for="currency_inr">INR</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" name="currency" type="radio" id="currency_usd" value="usd">
                    <label class="form-check-label" for="currency_usd">USD</label>
                </div>
            </div>
            <div class="row" style="margin: auto;">
                <!-- Free Tial -->
                <div class="col-sm col-md mt-4 p-0 bg-white rounded shadow">
                    <div class="pack-head p-4">
                        <h2 class="text-center text-primary">Free Trial</h2>
                    </div>
                    <div class="pack-price d-flex align-items-top py-4 bg-light">
                        <div class="pack-currenc fs-5 text-muted ml-auto"></div>
                        <div class="pack-value d-flex align-items-end mr-auto">
                            <div class="value">Free</div>
                            <div class="period">/ 30 Days only</div>
                        </div>
                    </div>
                    <div class="future text-center py-4 border-bottom">
                        <h3>10 Menus</h3>
                        <h3>10 Scans</h3>
                    </div>
                    <div class="pack-foot text-center py-4">
                        <!-- <a href="{%url 'qrmenu-activate_trial'%}" class="btn btn-success btn-lg">Try Now</a> -->
                        {%if restaurant.pack.pack_type == 0%}
                            <button class="btn btn-success btn-lg disabled">Active</button>
                        {%else%}
                            {%if not restaurant.is_free_pack_used%}
                            <button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#trial_pack_modal">Try Now</button>
                            {%else%}
                                <button class="btn btn-danger btn-lg disabled" disabled>Your Pack Expired</button>
                            {%endif%}
                        {%endif%}
                        
                    </div>
                </div>
                <!-- Monthly Pack -->
                <div class="col-sm col-md  offset-sm-1 mt-4 p-0 bg-white rounded shadow">
                    <div class="pack-head p-4">
                        <h2 class="text-center text-primary">Monthly Pack</h2>
                    </div>
                    <div class="pack-price d-flex align-items-top py-4 bg-light">
                        <div class="pack-currency fs-5 text-muted ml-auto">Rs</div>
                        <div class="pack-value d-flex align-items-end mr-auto">
                            <div id="monthly_value" class="value">199</div>
                            <div class="period">/ Month</div>
                        </div>
                    </div>
                    <div class="future text-center py-4 border-bottom">
                        <h3>Unlimited Menus</h3>
                        <h3>Unlimited Scans</h3>
                    </div>
                    <div class="pack-foot text-center py-4">
                        {%if restaurant.pack.pack_type == 1%}
                            <button class="btn btn-success btn-lg disabled">Active</button>
                        {%else%}
                            <button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#monthly_pack_modal">Buy Now</button>
                        {%endif%}
                        
                    </div>
                </div>
                
                <!-- Yearly Pack -->
                <div class="col-sm col-md  offset-sm-1 mt-4 p-0 bg-white rounded shadow">
                    <div class="pack-head p-4">
                        <h2 class="text-center text-primary">Yearly Pack</h2>
                    </div>
                    <div class="pack-price d-flex align-items-top py-4 bg-light">
                        <div class="pack-currency fs-5 text-muted ml-auto">Rs</div>
                        <div class="pack-value d-flex align-items-end mr-auto">
                            <div id="yearly_value" class="value">999</div>
                            <div class="period">/ Year</div>
                        </div>
                    </div>
                    <div class="future text-center py-4 border-bottom">
                        <h3>Unlimited Menus</h3>
                        <h3>Unlimited Scans</h3>
                    </div>
                    <div class="pack-foot text-center py-4">
                        {%if restaurant.pack.pack_type == 2%}
                            <button class="btn btn-success btn-lg disabled">Active</button>
                        {%else%}
                            <button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#yearly_pack_modal">Buy Now</button>
                        {%endif%}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {%endcomment%}
    <div class="container-fluid">
      <div class="d-flex flex-column vh-100">
        <div class="m-auto w-75">
          <div class="text-center text-light mb-5">
            <h1 class="text-center ">SELECT YOUR PACKAGE</h1>
            <div class="form-check form-check-inline">
                <input class="form-check-input" name="currency" type="radio" id="currency_inr" checked value="inr">
                <label class="form-check-label" for="currency_inr">INR</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" name="currency" type="radio" id="currency_usd" value="usd">
                <label class="form-check-label" for="currency_usd">USD</label>
            </div>
          </div>
          <div class="row align-items-center">
            <!-- Free Tial -->
            <div class="col-sm-12 col-md mt-4 p-0 bg-white rounded-3 shadow d-flex flex-column h-sm-auto" style="height: 50vh">
                <div class="p-4">
                    <h2 class="text-center text-primary">Free Trial</h2>
                </div>
                <div class="pack-price d-flex align-items-top py-4 bg-light">
                    <div class="pack-currenc fs-5 text-muted ml-auto"></div>
                    <div class="pack-value d-flex align-items-end mr-auto">
                        <div class="value">Free</div>
                        <div class="period">/ 30 Days only</div>
                    </div>
                </div>
                <div class="future text-primary text-center py-4">
                    <h3>10 Menus</h3>
                    <h3>10 Scans</h3>
                </div>
                <div class="pack-foot text-center p-4 mt-auto border-top">
                    <!-- <a href="{%url 'qrmenu-activate_trial'%}" class="btn btn-success btn-lg">Try Now</a> -->
                    {%if restaurant.pack.pack_type == 0%}
                        <button class="btn btn-success btn-lg disabled">Active</button>
                    {%else%}
                        {%if not restaurant.is_free_pack_used%}
                        <button class="btn btn-primary btn-lg rounded-pill w-100" data-toggle="modal" data-target="#trial_pack_modal">Try Now</button>
                        {%else%}
                            <button class="btn btn-danger btn-lg disabled" disabled>Your Pack Expired</button>
                        {%endif%}
                    {%endif%}
                    
                </div>
            </div>
            <!-- Yearly Pack -->
            <div class="col-sm-12 col-md mx-4 mt-4 p-0 bg-white rounded-3 shadow d-flex flex-column yearly-container h-sm-auto" style="height: 60vh">
                

                <div class="p-4">
                  <h2 class="text-center text-primary">Yearly Pack</h2>
                </div>
                <div class="pack-price d-flex align-items-top py-4 bg-light">
                    <div class="pack-currency fs-5 text-muted ml-auto">Rs</div>
                    <div class="pack-value d-flex align-items-end mr-auto">
                        <div id="yearly_value" class="value">999</div>
                        <div class="period">/ Year</div>
                    </div>
                </div>
                <div class="future text-primary text-center py-4 ">
                    <h3>Unlimited Menus</h3>
                    <h3>Unlimited Scans</h3>
                </div>
                <div class="pack-foot text-center p-4 mt-auto border-top">
                    {%if restaurant.pack.pack_type == 2%}
                        <button class="btn btn-success btn-lg disabled">Active</button>
                    {%else%}
                        <button class="btn btn-primary btn-lg rounded-pill w-100" data-toggle="modal" data-target="#yearly_pack_modal">Buy Now</button>
                    {%endif%}
                </div>
              </div>
            
            <!-- Monthly Pack -->
            <div class="col-sm-12 col-md  mt-4 p-0 bg-white rounded-3 shadow d-flex flex-column h-sm-auto" style="height: 50vh">
              <div class="p-4">
                <h2 class="text-center text-primary">Monthly Pack</h2>
              </div>
              <div class="pack-price d-flex align-items-top py-4 bg-light">
                  <div class="pack-currency fs-5 text-muted ml-auto">Rs</div>
                  <div class="pack-value d-flex align-items-end mr-auto">
                      <div id="monthly_value" class="value">199</div>
                      <div class="period">/ Month</div>
                  </div>
              </div>
              <div class="future text-primary text-center py-4">
                  <h3>Unlimited Menus</h3>
                  <h3>Unlimited Scans</h3>
              </div>
              <div class="pack-foot text-center p-4 mt-auto border-top">
                  {%if restaurant.pack.pack_type == 1%}
                      <button class="btn btn-success btn-lg disabled">Active</button>
                  {%else%}
                      <button class="btn btn-primary btn-lg rounded-pill w-100" data-toggle="modal" data-target="#monthly_pack_modal">Buy Now</button>
                  {%endif%}
                  
              </div>
            </div>
        </div>
        </div>
      </div>
    </div>
{%endblock%}
{%block script%}
<script src="https://www.paypal.com/sdk/js?client-id=test&currency=USD"></script>


    <!-- Set up a container element for the button -->

    


    <script>
        var csrf = $('input[name=csrfmiddlewaretoken]').val();
        //Curency change event.
        $('input[type=radio][name=currency]').change(function() {
            if (this.value == 'inr') {
                $('#monthly_modal_foot').html(`
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <form action="{%url 'payments-pay'%}">
                    <input type="hidden" name="pack_type" id="pack_type" value="1">
                    <input type="submit" class="btn btn-primary" value="Accept & Pay">
                </form>
                `)
                $('#yearly_modal_foot').html(`
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <form action="{%url 'payments-pay'%}">
                    <input type="hidden" name="pack_type" id="pack_type" value="2">
                    <input type="submit" class="btn btn-primary" value="Accept & Pay">
                </form>
                `)
                $('.pack-currency').text('Rs');
                $('#monthly_value').text('199');
                $('#yearly_value').text('999');
            }
            else if (this.value == 'usd') {
                $('#monthly_modal_foot').html(`
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <div id="paypal-monthly-container"></div>
                `)
                $('#yearly_modal_foot').html(`
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <div id="paypal-yearly-container"></div>
                `)
                $('.pack-currency').text('$');
                $('#monthly_value').text('2.50');
                $('#yearly_value').text('13');
                monthlyPayment();
                yearlyPayment();
                
            }
        });

    function monthlyPayment(){
    //For Monthly Pack
    const pack_type = '1'
    const amount = '2.50'
      paypal.Buttons({

        style: {

            layout:  'horizontal',
        
            color:   'blue',
        
            shape:   'rect',
        
            label:   'paypal',

            tagline:  false
        
          },
        // Sets up the transaction when a payment button is clicked

        createOrder: function(data, actions) {

          return actions.order.create({

            purchase_units: [{

              amount: {

                value: amount // Can reference variables or functions. Example: `value: document.getElementById('...').value`

              }

            }]

          });

        },


        // Finalize the transaction after payer approval

        onApprove: function(data, actions) {

          return actions.order.capture().then(function(orderData) {

            // Successful capture! For dev/demo purposes:

                console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));

                var transaction = orderData.purchase_units[0].payments.captures[0];

                //alert('Transaction '+ transaction.status + ': ' + transaction.id + '\n\nSee console for all available details');

                $.ajax({
                    url:"{%url 'payments-paypal'%}",
                    method:'post',
                    data:{
                      csrfmiddlewaretoken:csrf,
                      'transaction_id':transaction.id,
                      'pack_type':pack_type,
                      'amount' : amount,
                    
                    },
                    success:function(responce){
                        location.reload()
                    }
                });
          });

        }

      }).render('#paypal-monthly-container');


    }
    monthlyPayment();
   
    function yearlyPayment(){
        //For Yearly Pack paypal payment
        const pack_type = '2'
        const amount = '13.00'
      paypal.Buttons({

        style: {

            layout:  'horizontal',
        
            color:   'blue',
        
            shape:   'rect',
        
            label:   'paypal',

            tagline:  false
        
          },
        // Sets up the transaction when a payment button is clicked

        createOrder: function(data, actions) {

          return actions.order.create({

            purchase_units: [{

              amount: {

                value: amount // Can reference variables or functions. Example: `value: document.getElementById('...').value`

              }

            }]

          });

        },


        // Finalize the transaction after payer approval

        onApprove: function(data, actions) {

          return actions.order.capture().then(function(orderData) {

            // Successful capture! For dev/demo purposes:

                console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));

                var transaction = orderData.purchase_units[0].payments.captures[0];

                //alert('Transaction '+ transaction.status + ': ' + transaction.id + '\n\nSee console for all available details');

                $.ajax({
                    url:"{%url 'payments-paypal'%}",
                    method:'post',
                    data:{
                      csrfmiddlewaretoken:csrf,
                      'transaction_id':transaction.id,
                      'pack_type':pack_type,
                      'amount':amount,
                    
                    },
                    success:function(responce){
                      location.reload()
                    }
                });
          });

        }

      }).render('#paypal-yearly-container');


    }
    yearlyPayment()
    </script>
{%endblock%}